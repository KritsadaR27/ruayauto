# üöÄ AI ChatBot MVP Specification

## üìã **MVP Overview**
‡∏™‡∏£‡πâ‡∏≤‡∏á AI ChatBot ‡πÅ‡∏ó‡∏ô zwiz ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏™‡∏±‡πâ‡∏ô ‡πÅ‡∏ï‡πà‡∏ß‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï

---

## üéØ **MVP Scope (Phase 1 - ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÉ‡∏ô 2-3 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå)**

### üì• **Channel Integration**
‚úÖ **Facebook Messenger ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô** (‡πÉ‡∏ä‡πâ‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ)
- Webhook ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
- ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
- ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á Comment ‡πÅ‡∏•‡∏∞ Private Message

### üß† **AI Engine (Minimal)**
‚úÖ **Keyword + AI Hybrid**
- **Rule-based**: Keywords ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
- **AI-powered**: ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ OpenAI API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô
- **Fallback**: ‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö

### üí¨ **Core Features**
‚úÖ **‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ**
- ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å Facebook
- ‡∏ï‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ AI ‡∏´‡∏£‡∏∑‡∏≠ Keywords
- ‡πÄ‡∏Å‡πá‡∏ö Chat History
- ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏î‡∏π‡πÅ‡∏ä‡∏ó‡πÑ‡∏î‡πâ
- ‡∏õ‡∏¥‡∏î/‡πÄ‡∏õ‡∏¥‡∏î auto-reply ‡πÑ‡∏î‡πâ

‚ùå **‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ô MVP**
- LINE Integration
- TikTok, Shopee, Lazada
- Advanced Analytics
- AI Training Interface
- Multi-agent support

### üñ•Ô∏è **Admin Dashboard (Simple)**
‚úÖ **‡∏´‡∏ô‡πâ‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô**
- ‡∏î‡∏π Chat List + Chat History
- ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î AI Bot
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Keywords/Responses
- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ OpenAI API Key

---

## üèóÔ∏è **MVP Architecture (Simplified)**

### üìÅ **Directory Structure**
```
ruaymanagement/backend/
‚îú‚îÄ‚îÄ üîå external/
‚îÇ   ‚îî‚îÄ‚îÄ FacebookConnect/          # Port 8085
‚îÇ       ‚îú‚îÄ‚îÄ handlers/webhook.go   # ‡∏£‡∏±‡∏ö webhook
‚îÇ       ‚îî‚îÄ‚îÄ services/api.go       # ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
‚îÇ
‚îî‚îÄ‚îÄ üè¢ internal/
    ‚îî‚îÄ‚îÄ ChatBotCore/              # Port 8086 (All-in-one)
        ‚îú‚îÄ‚îÄ handlers/
        ‚îÇ   ‚îú‚îÄ‚îÄ chat.go           # Chat management
        ‚îÇ   ‚îú‚îÄ‚îÄ keywords.go       # Keyword management  
        ‚îÇ   ‚îî‚îÄ‚îÄ ai.go             # AI processing
        ‚îú‚îÄ‚îÄ services/
        ‚îÇ   ‚îú‚îÄ‚îÄ chatbot.go        # Main chatbot logic
        ‚îÇ   ‚îú‚îÄ‚îÄ ai_engine.go      # OpenAI integration
        ‚îÇ   ‚îî‚îÄ‚îÄ keyword_matcher.go # Keyword matching
        ‚îî‚îÄ‚îÄ repository/
            ‚îú‚îÄ‚îÄ chat_repo.go      # Chat history
            ‚îî‚îÄ‚îÄ keyword_repo.go   # Keywords
```

### üîÑ **Simplified Data Flow**
```
Facebook ‚Üí FacebookConnect ‚Üí ChatBotCore ‚Üí FacebookConnect ‚Üí Facebook
           (Webhook)        (AI + Keywords)   (Send Reply)
```

### üìä **MVP Database Schema**
```sql
-- Single schema for MVP
CREATE SCHEMA chatbot_mvp;

-- Chat conversations
CREATE TABLE chatbot_mvp.conversations (
    id SERIAL PRIMARY KEY,
    facebook_user_id VARCHAR(255) NOT NULL,
    user_name VARCHAR(255),
    status VARCHAR(20) DEFAULT 'active', -- active, closed, admin_mode
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- Chat messages
CREATE TABLE chatbot_mvp.messages (
    id SERIAL PRIMARY KEY,
    conversation_id INTEGER REFERENCES chatbot_mvp.conversations(id),
    message_text TEXT NOT NULL,
    sender_type VARCHAR(10) NOT NULL, -- 'user', 'bot', 'admin'
    message_type VARCHAR(20) DEFAULT 'text', -- text, image, quick_reply
    ai_used BOOLEAN DEFAULT false,
    matched_keyword VARCHAR(255),
    processing_time_ms INTEGER,
    facebook_message_id VARCHAR(255),
    created_at TIMESTAMP DEFAULT NOW()
);

-- Keywords (simple)
CREATE TABLE chatbot_mvp.keywords (
    id SERIAL PRIMARY KEY,
    keyword TEXT NOT NULL,
    response TEXT NOT NULL,
    is_active BOOLEAN DEFAULT true,
    priority INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT NOW()
);

-- Bot settings
CREATE TABLE chatbot_mvp.bot_settings (
    id SERIAL PRIMARY KEY,
    setting_key VARCHAR(100) UNIQUE NOT NULL,
    setting_value TEXT,
    updated_at TIMESTAMP DEFAULT NOW()
);

-- Initial settings
INSERT INTO chatbot_mvp.bot_settings (setting_key, setting_value) VALUES
('ai_enabled', 'true'),
('openai_api_key', ''),
('openai_model', 'gpt-3.5-turbo'),
('fallback_to_admin', 'true'),
('auto_reply_enabled', 'true');
```

---

## üîß **MVP Implementation Plan**

### **Week 1: Core Infrastructure**
1. ‚úÖ **Setup ChatBotCore service** (Port 8086)
2. ‚úÖ **Database schema** ‡πÅ‡∏•‡∏∞ repositories
3. ‚úÖ **Basic AI integration** (OpenAI API)
4. ‚úÖ **Keyword matching** system

### **Week 2: Facebook Integration**
1. ‚úÖ **Refactor FacebookConnect** (Port 8085)
2. ‚úÖ **Connect FacebookConnect ‚Üî ChatBotCore**
3. ‚úÖ **Chat history** ‡πÅ‡∏•‡∏∞ conversation management
4. ‚úÖ **Basic testing**

### **Week 3: Admin Dashboard**
1. ‚úÖ **Simple dashboard** (Next.js)
2. ‚úÖ **Chat list** ‡πÅ‡∏•‡∏∞ chat history viewer
3. ‚úÖ **Bot settings** page
4. ‚úÖ **Keywords management**

---

## üéõÔ∏è **MVP Configuration**

### **Environment Variables**
```env
# Facebook (existing)
FACEBOOK_PAGE_TOKEN=xxx
FACEBOOK_VERIFY_TOKEN=xxx

# OpenAI
OPENAI_API_KEY=xxx
OPENAI_MODEL=gpt-3.5-turbo
OPENAI_MAX_TOKENS=150

# Database (existing)
DB_HOST=postgres
DB_PORT=5432
DB_NAME=loyverse_cache

# Services
FACEBOOK_CONNECT_PORT=8085
CHATBOT_CORE_PORT=8086
```

### **Docker Compose (MVP)**
```yaml
version: '3.8'

services:
  postgres:
    image: postgres:13
    ports:
      - "5433:5432"
    
  facebook-connect:
    build: ./backend/external/FacebookConnect
    ports:
      - "8085:8085"
    depends_on:
      - postgres
      - chatbot-core
      
  chatbot-core:
    build: ./backend/internal/ChatBotCore
    ports:
      - "8086:8086"
    depends_on:
      - postgres
      
  frontend:
    build: ./frontend-next
    ports:
      - "3000:3000"
    depends_on:
      - chatbot-core
```

---

## üß† **MVP AI Logic**

### **Decision Tree**
```
Incoming Message
       ‚Üì
   Check Keywords
       ‚Üì
   ‚úÖ Match ‚Üí Send predefined response
       ‚Üì
   ‚ùå No Match ‚Üí Call OpenAI API
       ‚Üì
   ‚úÖ AI Response ‚Üí Send AI response
       ‚Üì
   ‚ùå AI Failed ‚Üí Send fallback message
       ‚Üì
   üìù Log everything
```

### **OpenAI Integration (Simple)**
```go
type AIRequest struct {
    Message string `json:"message"`
    Context string `json:"context,omitempty"`
}

type AIResponse struct {
    Response    string  `json:"response"`
    Confidence  float64 `json:"confidence"`
    ShouldReply bool    `json:"should_reply"`
}

// Simple prompt template
func buildPrompt(message, context string) string {
    return fmt.Sprintf(`
‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£
‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: %s
‡∏ö‡∏£‡∏¥‡∏ö‡∏ó: %s

‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏™‡∏±‡πâ‡∏ô‡πÜ ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏±‡∏ô‡πÄ‡∏≠‡∏á ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à‡πÉ‡∏´‡πâ‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
`, message, context)
}
```

---

## üì± **MVP User Stories**

### **‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (Facebook User)**
1. ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "‡∏´‡∏°‡∏π‡∏õ‡∏¥‡πâ‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà"
2. ‡∏ö‡∏≠‡∏ó‡∏ï‡∏≠‡∏ö "‡∏´‡∏°‡∏π‡∏õ‡∏¥‡πâ‡∏á‡πÑ‡∏°‡πâ‡∏•‡∏∞ 15 ‡∏ö‡∏≤‡∏ó ‡∏Ñ‡πà‡∏∞ ‡∏™‡∏±‡πà‡∏á‡∏Å‡∏µ‡πà‡πÑ‡∏°‡πâ‡∏î‡∏µ‡∏Ñ‡∏∞?"
3. ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ñ‡∏≤‡∏° "‡∏™‡πà‡∏á‡πÑ‡∏î‡πâ‡∏°‡∏±‡πâ‡∏¢"
4. ‡∏ö‡∏≠‡∏ó‡∏ï‡∏≠‡∏ö‡∏ú‡πà‡∏≤‡∏ô AI "‡∏™‡πà‡∏á‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏∞ ‡πÉ‡∏ô‡∏£‡∏±‡∏®‡∏°‡∏µ 5 ‡∏Å‡∏°. ‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á 20 ‡∏ö‡∏≤‡∏ó"
5. ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ñ‡∏≤‡∏° "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏õ‡∏¥‡∏î‡∏Å‡∏µ‡πà‡πÇ‡∏°‡∏á"
6. ‡∏ö‡∏≠‡∏ó‡∏ï‡∏≠‡∏ö‡∏ú‡πà‡∏≤‡∏ô keyword "‡πÄ‡∏õ‡∏¥‡∏î‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô 10:00-21:00 ‡∏Ñ‡πà‡∏∞"

### **‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô (Dashboard)**
1. ‡πÄ‡∏Ç‡πâ‡∏≤ Dashboard ‡πÄ‡∏´‡πá‡∏ô chat list
2. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏î‡∏π chat history ‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
3. ‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏ö‡∏≠‡∏ó‡∏ï‡∏≠‡∏ö‡∏≠‡∏∞‡πÑ‡∏£‡πÑ‡∏õ‡∏ö‡πâ‡∏≤‡∏á
4. ‡∏õ‡∏¥‡∏î auto-reply ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ
5. ‡πÄ‡∏û‡∏¥‡πà‡∏° keyword ‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ

---

## üéØ **MVP Success Metrics**

### **Technical**
- ‚úÖ Response time < 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
- ‚úÖ 99% uptime
- ‚úÖ Handle 100 messages/day

### **Business**
- ‚úÖ ‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡∏≠‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ 80%
- ‚úÖ ‡∏ï‡∏≠‡∏ö‡πÑ‡∏î‡πâ 70% ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
- ‚úÖ ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô dashboard ‡πÑ‡∏î‡πâ

---

## üöÄ **Future Roadmap (Post-MVP)**

### **Phase 2** (Month 2-3)
- LINE Integration
- Advanced Analytics
- AI Training Interface
- Multi-language support

### **Phase 3** (Month 4-6)
- TikTok, Shopee Integration
- Advanced AI (RAG, Fine-tuning)
- A/B Testing
- Performance optimization

### **Phase 4** (Month 6+)
- Voice messages
- Image recognition
- E-commerce integration
- Multi-tenant support

---

## ‚úÖ **MVP Acceptance Criteria**

1. **Facebook Integration**: ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏î‡πâ
2. **AI Response**: ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ú‡πà‡∏≤‡∏ô OpenAI ‡πÑ‡∏î‡πâ
3. **Keyword System**: ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÑ‡∏î‡πâ
4. **Chat History**: ‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏•‡∏∞‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÑ‡∏î‡πâ
5. **Admin Dashboard**: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÑ‡∏î‡πâ
6. **Deployment**: Deploy ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏î‡πâ

---

*MVP ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö AI ChatBot ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏ó‡∏ô zwiz ‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 3 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏Ç‡∏¢‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï*
